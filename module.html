<!DOCTYPE html>
<html>

<head>
  <title>CyboShool</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- bootstrap links -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <!-- for icon to module -->
  <script src="https://kit.fontawesome.com/ce4743e969.js" crossorigin="anonymous"></script>

  <!-- for module javascript code  -->
  <script src="./questions/myscript.js"></script>
  <!-- for module css -->
  <link rel="stylesheet" href="./questions/module1.css">
  <!-- for facejs  -->
  <script defer src="./libs/face-api.min.js"></script>
  <!-- face recognitioin script -->
  <script defer src="./facerecognition/script.js"></script>
  <!-- insert my css -->
  <link rel="stylesheet" href="./style.css">


  <!-- for Text To Spech  -->
  <script src="https://code.responsivevoice.org/responsivevoice.js?key=DV3DznWY"></script>

  <script src="./voice.js"></script>
  <style>
    .modal-backdrop {
      z-index: -10;
    }
  </style>

</head>


<body onload="initialitation();">
  <!--  model start -->
  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
    aria-hidden="true" style="color: black;">
    <div class=" modal-dialog modal-sm" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>

        </div>
        <div class="modal-body" id="modelBody">
          ...
        </div>
        <div class="modal-footer">

          <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal"></button> -->
          <button type="button" class="btn btn-primary" id="nextQuecBtn" style="display: none;">Go To Next
            Quection</button>
        </div>
      </div>
    </div>
  </div>
  <button class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" id="modelDisplayBtn1"
    style="display: none;">Click</button>

  <button class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter" id="modelDisplayBtn2"
    style="display: none;">Click</button>

  <!-- model end -->
  <div style="background-color: #7efff5;width: 200px;height: 100px;position: absolute;top: 30px;right: 0px;">
    <div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">

      </div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6">
        <video id="video" width="100" height="100" autoplay muted
          style="position: absolute;border-radius: 50%;z-index: 50;"></video>
        <div class="" id="dataShow" style="width: 100px;height: 100px;z-index: 60;position: absolute;"></div>
      </div>
    </div>

  </div>
  <!-- start continer -->
  <div class="container-fluid" style="height: 90vh;width: 100vw;position: absolute;z-index: 10;">
    <!-- start head row -->
    <div class="row" style="height: 10vh;width: 100vw;">
      <div>
        <h6 class="neon-textHeader">CYBOSHOOL</h6>
      </div>
      <div style="float: right;">

      </div>
    </div>
    <!-- close head row -->
    <!-- start body row -->
    <div class="row">

      <!-- question container view -->
      <div class="col-sm-12 col-md-8 col-lg-8 col-xl-8" style="height: 90vh;">

        <!-- question html start -->
        <div style="width:40vw;" onmouseleave="mouseGoOut();" onmouseenter="mouseGoIn();">
          <div
            style="border-radius: 20px;border: 5px solid #7efff5;padding-left: 100px;margin-right: -200px;margin-top: 100px;padding-bottom: 80px;  background: rgba(0,0,0,0.5);"
            class="neon-wrapper">
            <div class="row " style="margin-top: 50px;">
              <div class="row">
                <div class="col-sm-12 col-md-11 col-lg-11 col-xl-11 ">
                  <h4 id="QuectionContainer"></h4>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-12 col-md-11 col-lg-11 col-xl-11 ">
                  <hr style="border-top: 1px solid #7efff5; margin-top: -2px;">
                  <p>
                  <div id="Block" style="width: 700px;"></div>
                  </p>

                </div>
              </div>
              <div class="row">
                <div class="col-sm-12 col-md-11 col-lg-11 col-xl-11 " style="margin-top: 50px;">
                  <div class="form-group">
                    <label for="usr">Answer :</label>
                    <input type="text" class="form-control" id="userInput">
                  </div>
                  <div class="form-group">
                    <button class="btn btn-outline-danger" value="submit" id="submit" onclick="checkAnsw();">Submite
                      Answer</button>
                  </div>

                </div>

              </div>
              <br>
              <div class="row" style="width: 500px;padding-top: 90px;">
                <div class="col-sm-12 col-md-11 col-lg-11 col-xl-11">
                  <div class="form-group">
                    <label for="usr" id="answer"></label>
                  </div>
                  <div class="form-group">
                    <button class="btn btn-outline-primary" value="submit" id="nextQuectionButton"
                      onclick="nextQuection();game.playAnimation.call(game, 1);" style="display: none;">Next
                      Answer</button>

                    <button class="btn btn-outline-primary" value="submit" onclick="myTyping();"
                      style="display: none;">Next Answer</button>

                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- question html end-->
      </div>

      <!-- question container view end -->
      <div class="col-sm-12 col-md-4 col-lg-4 col-xl-4" style="height: 90vh;">
        <div class="row" style="height: 10vh;">

        </div>
        <div class="row" style="height: 25vh;">
          <div>
            <h3 id="tts_text"></h3>
          </div>

          <div style="width: 500px;height: 80px;">
            <div id="text" style="display: none;"></div>
          </div>
        </div>

      </div>
    </div>

  </div>
  <div id="3dcView" style="position: absolute;">
  </div>

  <script src="libs/three.min.js"></script>
  <script src="libs/inflate.min.js"></script>
  <script src="libs/FBXLoader.js"></script>
  <script src="libs/OrbitControls.js"></script>
  <script src="game.js"></script>

  <script>
    var string = "Cyber School";
    var array = string.split("");
    var timer;
    document.getElementById("tts_text").innerText = "";
    function frameLooper() {

      if (array.length > 0) {
        document.getElementById("tts_text").innerHTML += array.shift();
      } else {
        clearTimeout(timer);
      }
      loopTimer = setTimeout('frameLooper()', 70); /* change 70 for speed */

    }
    var game;
    var faceExpresion;
    var acount = 0;
    var noFaceCount = 0;
    var HappyFaceCount = 0;
    var angryFaceCount = 0;
    var IsInDiv = true;
    var IsFirst = true;
    var temp = false;
    function initialitation() {
      randomNumberGet();
      game = new Game();
      game.onLoad();
      window.game = game;
      //sayTextGet(document.getElementById("QuectionContainer").innerText);


    }

    function mouseGoIn() {
      if (IsFirst) {
        game.playAnimation.call(game, 1);//1
        string = sayTextGet('voiceDivInFirst');
        array = string.split("");
        frameLooper();
        //document.getElementById('modelDisplayBtn2').click();
        IsFirst = false;
        noFaceCount = 0;
        cameraStart();

      } else {
        //4 paweno 
        // 6 bepa
        //9 dance  -13 dance
        game.playAnimation.call(game, 1);

        string = sayTextGet('voiceDivInNoFirst');
        array = string.split("");
        document.getElementById("tts_text").innerText = "Teacher : ";
        frameLooper();
        noFaceCount = 0;
      }
      IsInDiv = true;
    }

    function mouseGoOut() {
      game.playAnimation.call(game, 0);//0
      string = sayTextGet('voiceDivOut');
      document.getElementById("tts_text").innerText = "Teacher : ";
      array = string.split("");
      frameLooper();

      IsInDiv = false;
      noFaceCount = 0;
    }

    function checkAnsw() {
      if (checkAnswerModel1()) {
        string = sayTextGet('voiceCorrectAnsw');
        document.getElementById("tts_text").innerText = "Teacher : ";
        array = string.split("");
        frameLooper();

        game.playAnimation.call(game, 3);
      } else {
        string = sayTextGet('voiceWrongAnsw');
        document.getElementById("tts_text").innerText = "Teacher : ";
        array = string.split("");
        frameLooper();

        game.playAnimation.call(game, 0);
      }
    }

    function cameraStart() {
      setInterval(function () {
        faceExpresion = getExpresion();

        console.log("facial Exprerssion is -" + faceExpresion);
        if (faceExpresion == null) {
          noFaceCount++;
          if (noFaceCount == 10) {
            noFaceCount = 0;
            game.playAnimation.call(game, 8);
            string = sayTextGet('voiceNoFace');
            document.getElementById("tts_text").innerText = "Teacher : ";
            array = string.split("");
            frameLooper();
            //document.getElementById('modelDisplayBtn2').click();
          }
        } else if (faceExpresion == "happy") {

          HappyFaceCount++;
          if (HappyFaceCount == 3) {
            HappyFaceCount = 0;
            if (IsInDiv) {
              game.playAnimation.call(game, 4);
              string = sayTextGet('voiceDivInHappy');
              document.getElementById("tts_text").innerText = "Teacher : ";
              array = string.split("");
              frameLooper();

            } else {
              game.playAnimation.call(game, 4);
              string = sayTextGet('voiceDivOutHappyt');
              document.getElementById("tts_text").innerText = "Teacher : ";
              array = string.split("");
              frameLooper();

            }
          }

        } else if (faceExpresion == "angry") {

          angryFaceCount++;
          if (angryFaceCount == 5) {
            angryFaceCount = 0;
            game.playAnimation.call(game, 9);
            string = sayTextGet('voiceangry');
            document.getElementById("tts_text").innerText = "Teacher : ";
            array = string.split("");
            frameLooper();
            setTimeout(function () { game.playAnimation.call(game, 10); }, 1000);
            setTimeout(function () { game.playAnimation.call(game, 10); }, 1000);

          }

        }
      }, 1000);
    }
    function myTyping() {
      document.getElementById("tts_text").innerText = "tts_text";
    }

  </script>
</body>

</html>